import{u as e,b as a,_ as t}from"./index-3064f07a.js";import{E as s}from"./el-infinite-scroll-8f336740.js";import{_ as l}from"./Cover-c9cf5b69.js";import{j as i,o as r,t as o,v as c,c as n,G as u,a0 as v,a as p,C as m,y,u as d,F as f,T as g,M as x,n as h,ad as k,r as w,ae as b,E as q,z as T,A as _,V as M,k as j}from"./common-e50ab5ff.js";import"./format-219ee090.js";const C={key:0,class:"space-y-8 p-8 bg-gray-300 bg-opacity-30 rounded-lg text-gray-800 text-opacity-80 origin-top"},$={class:"text-2xl font-bold flex-shrink-0 h-10 flex items-center"},L={class:"flex flex-wrap"},A=["onClick"],E={__name:"TagSelector",props:{showMore:{type:Boolean,required:!0},activeTags:{type:Array,required:!0}},setup(t){const s=e(),l=i((()=>a.explore.categories)),x=e=>a.explore.tags.filter((a=>a.category===1*e));return(e,a)=>(r(),o(g,{name:"tagSelector",mode:"in-out"},{default:c((()=>[t.showMore?(r(),n("div",C,[(r(!0),n(u,null,v(d(l),((e,a)=>(r(),n("div",{key:a,class:"flex space-x-8"},[p("h3",$,m(e),1),p("div",L,[(r(!0),n(u,null,v(x(a),((e,a)=>(r(),n("div",{key:a,class:"flex min-w-24 items-center justify-center"},[p("span",{class:y(["h-10 py-1 px-2.5 flex items-center justify-center rounded-md hover:bg-skin-primary hover:bg-opacity-30 hover:text-skin-primary cursor-pointer",t.activeTags.includes(e.name)?"text-skin-primary":""]),onClick:a=>d(s).storeTags(e)},m(e.name),11,A)])))),128))])])))),128))])):f("",!0)])),_:1}))}},S=["onClick"],z={__name:"ExploreTag",props:{activeTags:{type:Array,required:!0},category:{type:String,required:!0},showMore:{type:Boolean,required:!0}},emits:["update:showMore"],setup(e,{emit:a}){const t=x();return(s,l)=>(r(),o(k,{name:"tagList",class:"flex flex-wrap mb-4 relative",tag:"div"},{default:c((()=>[(r(!0),n(u,null,v(e.activeTags,(s=>(r(),n("div",{key:s,class:y(["selector-tag transition-all",e.category!==s||e.showMore?"":"activeTag"]),onClick:e=>(e=>{t.push({path:"/explore",query:{cat:e}}),a("update:showMore",!1)})(s)},m(s),11,S)))),128)),h(s.$slots,"more")])),_:3}))}},B={key:0},P={class:"font-bold text-6xl my-8"},F={class:"mt-12 grid gap-10 grid-cols-6 lg:gap-x-5","infinite-scroll-immediate":!1,"infinite-scroll-distance":"300","infinite-scroll-delay":"500"},G={class:"absolute right-0 top-2 flex justify-center items-center pr-3 pt-0.5"},H={class:"italic text-white text-sm lg:text-xs flex-shrink-0 font-semibold text-opacity-90"},R={__name:"Explore",setup(a){const o=e(),{proxy:g}=j(),x=M(),h=w(!1),k=i((()=>{const{query:e}=x;return(null==e?void 0:e.cat)||"全部"})),C=w(24),$=w(0),L=w(!0),A=w(null),S=()=>{R.value=[],$.value=0,L.value=!0,A.value=null},R=w([]),U=({limit:e,cat:a,offset:t,before:s})=>{"排行榜"!==a?"精品歌单"!==a?"推荐歌单"!==a?g.$http.reqPlayList({limit:e,cat:a,offset:t}).then((e=>{R.value=[...R.value,...e.data.playlists],L.value=e.data.more})):g.$http.reqAlbumListList({limit:100}).then((e=>{R.value=[...R.value,...e.data.result]})):g.$http.reqHighqualityPlaylist({limit:24,cat:"全部",before:s}).then((e=>{R.value=[...R.value,...e.data.playlists],L.value=e.data.more,A.value=e.data.lasttime})):g.$http.reqRankList().then((e=>{R.value=e.data.list}))},V=()=>{"排行榜"!==k.value&&"推荐歌单"!==k.value&&L.value&&($.value++,U({limit:C.value,cat:k.value,offset:$.value*C.value,before:A.value}))};b((e=>{S(),U({limit:C.value,cat:e.query.cat})}));const D=w(!1);return q((()=>{D.value=!0,S(),U({limit:C.value,cat:k.value,offset:$.value*C.value})})),(e,a)=>{const i=z,g=E,x=t,w=l,b=s;return D.value?(r(),n("div",B,[p("h3",P,m(e.$t.explore.title),1),T(i,{showMore:h.value,"onUpdate:showMore":a[1]||(a[1]=e=>h.value=e),"active-tags":d(o).settings.activeTags,category:d(k)},{more:c((()=>[p("div",{class:y(["selector-tag",h.value?"activeTag":""]),onClick:a[0]||(a[0]=e=>h.value=!h.value)}," ••• ",2)])),_:1},8,["showMore","active-tags","category"]),T(g,{"show-more":h.value,"active-tags":d(o).settings.activeTags},null,8,["show-more","active-tags"]),_((r(),n("div",F,[(r(!0),n(u,null,v(R.value,((e,a)=>(r(),n("div",{key:a},[T(w,{"row-list-item":e},{playCount:c((({playCount:e})=>[p("div",G,[T(x,{name:"play",size:"18",class:"opacity-90 text-white"}),p("span",H,m(e),1)])])),_:2},1032,["row-list-item"])])))),128))])),[[b,V]])])):f("",!0)}}};export{R as default};
