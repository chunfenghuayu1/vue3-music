import{O as E,m as R,P as B,o as t,s as j,w as k,c as o,F as T,e as $,a as d,t as h,A as M,v as y,u as A,T as z,E as F,N as U,Q as G,f as m,R as H,j as O,b as w,L as Q,S as J,B as K,_ as W}from"./index.3cf213f0.js";import{E as X}from"./el-infinite-scroll.dfc4ff8d.js";import{_ as Y}from"./Cover.25c46fc4.js";import"./format.3c5dc5cf.js";const Z={key:0,class:"space-y-8 p-8 bg-gray-300 bg-opacity-30 rounded-lg text-gray-800 text-opacity-80 origin-top"},ee={class:"text-2xl font-bold flex-shrink-0 h-10 flex items-center"},te={class:"flex flex-wrap"},ae=["onClick"],se={__name:"TagSelector",props:{showMore:{type:Boolean,required:!0},activeTags:{type:Array,required:!0}},setup(p){const g=E(),c=R(()=>B.explore.categories),f=e=>B.explore.tags.filter(r=>r.category===e*1);return(e,r)=>(t(),j(z,{name:"tagSelector",mode:"in-out"},{default:k(()=>[p.showMore?(t(),o("div",Z,[(t(!0),o(T,null,$(y(c),(a,u)=>(t(),o("div",{key:u,class:"flex space-x-8"},[d("h3",ee,h(a),1),d("div",te,[(t(!0),o(T,null,$(f(u),(v,_)=>(t(),o("div",{key:_,class:"flex min-w-24 items-center justify-center"},[d("span",{class:M(["h-10 py-1 px-2.5 flex items-center justify-center rounded-md hover:bg-skin-primary hover:bg-opacity-30 hover:text-skin-primary cursor-pointer",p.activeTags.includes(v.name)?"text-skin-primary":""]),onClick:S=>y(g).storeTags(v)},h(v.name),11,ae)]))),128))])]))),128))])):A("",!0)]),_:1}))}},oe=["onClick"],re={__name:"ExploreTag",props:{activeTags:{type:Array,required:!0},category:{type:String,required:!0},showMore:{type:Boolean,required:!0}},emits:["update:showMore"],setup(p,{emit:g}){const c=F(),f=e=>{c.push({path:"/explore",query:{cat:e}}),g("update:showMore",!1)};return(e,r)=>(t(),j(G,{name:"tagList",class:"flex flex-wrap mb-4 relative",tag:"div"},{default:k(()=>[(t(!0),o(T,null,$(p.activeTags,a=>(t(),o("div",{key:a,class:M(["selector-tag transition-all",p.category===a&&!p.showMore?"activeTag":""]),onClick:u=>f(a)},h(a),11,oe))),128)),U(e.$slots,"more")]),_:3}))}},le={key:0},ne={class:"font-bold text-6xl my-8"},ie={class:"mt-12 grid gap-10 grid-cols-6 lg:gap-x-5","infinite-scroll-immediate":!1,"infinite-scroll-distance":"300","infinite-scroll-delay":"500"},ce={class:"absolute right-0 top-2 flex justify-center items-center pr-3 pt-0.5"},ue={class:"italic text-white text-sm lg:text-xs flex-shrink-0 font-semibold text-opacity-90"},ge={__name:"Explore",setup(p){const g=E(),{proxy:c}=K(),f=J(),e=m(!1),r=R(()=>{const{query:n}=f;return(n==null?void 0:n.cat)||"\u5168\u90E8"}),a=m(24),u=m(0),v=m(!0),_=m(null),S=()=>{l.value=[],u.value=0,v.value=!0,_.value=null},l=m([]),b=({limit:n,cat:i,offset:C,before:q})=>{if(i==="\u6392\u884C\u699C"){c.$http.reqRankList().then(s=>{l.value=s.data.list});return}if(i==="\u7CBE\u54C1\u6B4C\u5355"){c.$http.reqHighqualityPlaylist({limit:24,cat:"\u5168\u90E8",before:q}).then(s=>{l.value=[...l.value,...s.data.playlists],v.value=s.data.more,_.value=s.data.lasttime});return}if(i==="\u63A8\u8350\u6B4C\u5355"){c.$http.reqAlbumListList({limit:100}).then(s=>{l.value=[...l.value,...s.data.result]});return}c.$http.reqPlayList({limit:n,cat:i,offset:C}).then(s=>{l.value=[...l.value,...s.data.playlists],v.value=s.data.more})},N=()=>{r.value==="\u6392\u884C\u699C"||r.value==="\u63A8\u8350\u6B4C\u5355"||v.value&&(u.value++,b({limit:a.value,cat:r.value,offset:u.value*a.value,before:_.value}))};H(n=>{S(),b({limit:a.value,cat:n.query.cat})});const L=m(!1);return O(()=>{L.value=!0,S(),b({limit:a.value,cat:r.value,offset:u.value*a.value})}),(n,i)=>{const C=re,q=se,s=W,P=Y,D=X;return L.value?(t(),o("div",le,[d("h3",ne,h(n.$t.explore.title),1),w(C,{showMore:e.value,"onUpdate:showMore":i[1]||(i[1]=x=>e.value=x),"active-tags":y(g).settings.activeTags,category:y(r)},{more:k(()=>[d("div",{class:M(["selector-tag",e.value?"activeTag":""]),onClick:i[0]||(i[0]=x=>e.value=!e.value)}," \u2022\u2022\u2022 ",2)]),_:1},8,["showMore","active-tags","category"]),w(q,{"show-more":e.value,"active-tags":y(g).settings.activeTags},null,8,["show-more","active-tags"]),Q((t(),o("div",ie,[(t(!0),o(T,null,$(l.value,(x,I)=>(t(),o("div",{key:I},[w(P,{"row-list-item":x},{playCount:k(({playCount:V})=>[d("div",ce,[w(s,{name:"play",size:"18",class:"opacity-90 text-white"}),d("span",ue,h(V),1)])]),_:2},1032,["row-list-item"])]))),128))])),[[D,N]])])):A("",!0)}}};export{ge as default};
